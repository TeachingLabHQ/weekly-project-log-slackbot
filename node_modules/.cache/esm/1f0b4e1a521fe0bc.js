let App,WebClient,SLACK_OAUTH_TOKEN;_521‍.w("@slack/bolt",[["App",["App"],function(v){App=v}]]);_521‍.w("@slack/web-api",[["WebClient",["WebClient"],function(v){WebClient=v}]]);_521‍.w("./constants",[["SLACK_OAUTH_TOKEN",["SLACK_OAUTH_TOKEN"],function(v){SLACK_OAUTH_TOKEN=v}]]);







const app = new App({
    signingSecret:'4f0467db4550742e8cfb92f09843004d',
    token: 'xoxb-573391640452-5456788506535-NtiIALTaIlDNpaGXEg18SJKW',
    appToken: 'xapp-1-A05DEJ10J23-5485076439345-0542ae7ba686731a5ef8cd2cf172debe3470b5b6bfab1825d3476ef0dc1c4e30',
    socketMode: true,
});

app.message('hello', async ({ message, client, say }) => {
    // say() sends a message to the channel where the event was triggered
    // console.log(message.user);
    _521‍.g.console.log(app.client.users.info('xoxb-573391640452-5456788506535-NtiIALTaIlDNpaGXEg18SJKW',message.user));
    await say(`Hey there <@${message.user}>!`);
    var totallog;
    var i = 1;
    while(i != 0){
      console.log("running");
      let logArray = await fetch ("https://api.monday.com/v2", {
        method: 'post',
        headers: {
            'Content-Type': 'application/json',
            'Authorization' : "eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjIzNDI2ODE2OCwidWlkIjozMTI4ODQ0NCwiaWFkIjoiMjAyMy0wMi0wM1QwMDozNjoyMC4wMDBaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6ODg4NDgxOSwicmduIjoidXNlMSJ9.oM37gRdrLf8UnnmuZIM-QWDRoT_GtgFLLyHpvnxGUtQ"
        },
        body: JSON.stringify({
            'query' : '{boards (ids: 4284585496) {items(limit: 50 page:'+ i +') {  group{title} column_values(ids:[people,date4,numbers8]) {title text} subitems { name column_values(ids:[name6,project_role,numbers]) {title text}}}}}',
            // 'variables' : JSON.stringify(req.body.vars)
        })
        }).then((res) => res.json())
        .then((result) => {return result});
        _521‍.g.console.log(logArray);
        if(logArray.data.boards[0].items.length == 0){
          i = 0;
        }
        else{
          if(totallog == null){
            totallog=logArray;
          }
          else{
            var concatArray = totallog.data.boards[0].items.concat(logArray.data.boards[0].items);
            totallog.data.boards[0].items = concatArray;
          }
          i++;
        }
    }
   
          // console.log(JSON.stringify(totallog, null, 2));
          // console.log(totallog.data.boards[0].items.length);


        
          
   
  });

  (async () => {
    // Start your app
    await app.start(3000);

    console.log('⚡️ Bolt app is running!');
  })();

//   await app.client.chat.postMessage({
//     token:'xoxb-573391640452-5456788506535-vj62rGaBquZJ4bEHwo08IsPc',
//     channel:'test',
//     text:'hello'
// });

